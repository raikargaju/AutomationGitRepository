package test7;

import java.io.FileInputStream;
import java.io.FileOutputStream;

import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
public class Q5CityName2ndHalfExcel {

	public static void main(String[] args) {
		// Q4 City Name 2nd Half Excel
        try
        {
            FileInputStream fin = new FileInputStream("E:\\JavaTests\\AutomationTests\\src\\test7\\City.xlsx");
            Workbook workbook = WorkbookFactory.create(fin);
            Sheet sheet1 = workbook.getSheetAt(0);
            int rowCount = sheet1.getPhysicalNumberOfRows();
            int startRow = rowCount / 2;
            try (Workbook newWorkbook = new XSSFWorkbook()) {
				Sheet sheet2 = newWorkbook.createSheet("Sheet2");
				for (int i = startRow; i < rowCount; i++)
				{
				    Row sourceRow = sheet1.getRow(i);
				    Row destRow = sheet2.createRow(i - startRow);
				    Cell sourceCell = sourceRow.getCell(0);
				    String cellValue = (sourceCell == null) ? "" : sourceCell.getStringCellValue();
				    Cell destCell = destRow.createCell(0);
				    destCell.setCellValue(cellValue);
				}
				FileOutputStream fileOutputStream = new FileOutputStream("E:\\JavaTests\\AutomationTests\\src\\test7\\City.xlsx");
				newWorkbook.write(fileOutputStream);
				fin.close();
				fileOutputStream.close();
			}
            System.out.println("Excel file is Modified...!");
        } catch (Exception e)
        {
            e.printStackTrace();
        }
	}
}