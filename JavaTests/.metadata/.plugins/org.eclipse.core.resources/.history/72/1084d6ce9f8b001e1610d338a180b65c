package test7;

import java.io.FileInputStream;
import java.io.FileOutputStream;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.WorkbookFactory;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class Q2FruitsNameReadAndWriteReverseExcel {

	public static void main(String[] args) {
		// Q2 Fruits Name Read And Write Reverse Order Excel
        try {
            // Load the Excel file
            FileInputStream fileInputStream = new FileInputStream("your_excel_file.xlsx");
            Workbook workbook = WorkbookFactory.create(fileInputStream);

            // Get the first sheet (Sheet1)
            Sheet sheet1 = workbook.getSheetAt(0);

            // Get the number of rows in Sheet1
            int rowCount = sheet1.getPhysicalNumberOfRows();

            // Get or create the second sheet (Sheet2)
            Sheet sheet2 = workbook.getSheet("Sheet2");
            if (sheet2 == null) {
                sheet2 = workbook.createSheet("Sheet2");
            }

            // Write fruit names in reverse order to Sheet2
            for (int i = 0; i < rowCount; i++) {
                Row sourceRow = sheet1.getRow(i);
                Row destRow = sheet2.getRow(rowCount - 1 - i);

                if (destRow == null) {
                    destRow = sheet2.createRow(rowCount - 1 - i);
                }

                // Get the cell value from the first column of Sheet1
                Cell sourceCell = sourceRow.getCell(0);
                String cellValue = (sourceCell == null) ? "" : sourceCell.getStringCellValue();

                // Create a new cell in the first column of Sheet2 and set the value
                Cell destCell = destRow.createCell(0);
                destCell.setCellValue(cellValue);
            }

            // Save the changes to the same Excel file
            FileOutputStream fileOutputStream = new FileOutputStream("your_excel_file.xlsx");
            workbook.write(fileOutputStream);

            // Close the input and output streams
            fileInputStream.close();
            fileOutputStream.close();

            System.out.println("Fruit names written in reverse order to Sheet2 in the same Excel file.");

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}

